# 所有权

### 编程语言分类

在Rust出现以前，世界上所有的语言可以分为两类
- 手动管理内存的
- 带GC的不需要管理内存的

第一类以语言中的大爷`C`为代表，第二类以`Python`为代表。
`Rust`的出现可以说是编程语言界一个值得记录历史事件，因为它开创了第三类内存管理风格：**编译器管理**。

#### 各类内存管理的优缺点

手动管理内存最大缺点是，容易出错。不是忘记初始化，就是忘记释放，导致各种程序bug。好处就是你可以深入到每一个字节的内存管理，如果你足够有能力，可以让你最大化资源利用率。

GC最大的问题就是，性能抖动。因为它需要时不时在后台清理一下内存，会影响程序的正常运行(STW)。对于实时性和确定性敏感的应用，是不会用GC类语言去开发的。好处就是，你不用管变量怎么分配，声明然后使用就完事了。

而Rust通过编译器管理，不仅去除了手动管理内存的缺点，还克服了GC的性能问题，因为是在编译期就确定了，而不是在运行时。同时还拥有了GC类语言直接使用变量的优点。

当然也有缺点，就是为了支持编译期内存的自动管理，Rust发明了所有权机制，通过借用检查器，来保证内存资源使用的合规。带来的问题就是，你写的代码很大概率不符合编译器的要求
```rust
fn main() {
	let msg = "world".to_string();
	hello(msg);
	println!("{msg}");
}

fn hello(greet: String) {
	greet += "!";
	println!("Hello {greet}");
}
```
上面代码在其他语言里，是没有问题的。但是在rust里，根本跑不起来！感兴趣可以自己到[Rust playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021)跑跑看。

**注：** 这边说的内存特指堆内存，因为栈内存各语言都是编译器根据调用栈自动分配和释放的。

